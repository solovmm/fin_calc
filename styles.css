:root{
      --bg1:#070814;
      --bg2:#0b1a2a;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --muted2:rgba(255,255,255,.55);
      --accent:#7c3aed;
      --accent2:#22c55e;
      --danger:#ef4444;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --r:18px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      background: radial-gradient(1000px 600px at 15% 0%, rgba(124,58,237,.28), transparent 60%),
                  radial-gradient(900px 600px at 80% 30%, rgba(34,197,94,.16), transparent 55%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      padding:28px 18px;
    }
    .wrap{max-width:1080px;margin:0 auto}
    .top{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{
      width:40px;height:40px;border-radius:12px;
      background: linear-gradient(135deg, rgba(124,58,237,.9), rgba(34,197,94,.55));
      box-shadow: 0 10px 26px rgba(124,58,237,.25);
      display:grid;place-items:center;font-weight:800;
    }
    .title{line-height:1.1}
    .title h1{font-size:18px;margin:0}
    .title p{font-size:13px;margin:4px 0 0;color:var(--muted)}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{
      appearance:none;border:1px solid var(--stroke);background:rgba(255,255,255,.04);
      color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;
      display:inline-flex;gap:8px;align-items:center;font-weight:650;
    }
    .btn:hover{background:rgba(255,255,255,.06)}
    .grid{display:grid;grid-template-columns: 1.05fr .95fr;gap:16px}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:16px;
      overflow:hidden;
    }
    .card h2{margin:0 0 12px;font-size:16px}
    .row{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    @media (max-width:560px){.row{grid-template-columns:1fr}}
    .field{position:relative}
    label{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:12.5px;margin:0 0 8px}
    .help{
      width:18px;height:18px;border-radius:999px;border:1px solid var(--stroke);
      background:rgba(255,255,255,.04);color:var(--muted);
      display:inline-grid;place-items:center;font-size:12px;cursor:pointer;user-select:none;
    }
    .help:hover{background:rgba(255,255,255,.06)}
    input, select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      font-size:15px;
    }
    select{cursor:pointer}
    .money{
      display:flex;align-items:center;gap:10px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
    }
    .money span{
      color:var(--muted);
      font-weight:700;
      width:14px;
    }
    .money input{
      border:none;background:transparent;padding:0;
      font-size:16px;
    }
    .swapline{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin:10px 0 0;
      padding:10px 12px;border-radius:14px;border:1px solid var(--stroke);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12.5px;
    }
    .swapbtn{
      border:none;background:rgba(255,255,255,.05);color:var(--text);
      padding:8px 10px;border-radius:12px;cursor:pointer;font-weight:750;
      border:1px solid var(--stroke);
    }
    .swapbtn:hover{background:rgba(255,255,255,.08)}
    .cta{
      margin-top:14px;
      display:flex;gap:10px;align-items:center;justify-content:flex-end;flex-wrap:wrap;
    }
    .primary{
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(124,58,237,.65));
      border:1px solid rgba(124,58,237,.55);
      padding:12px 16px;border-radius:14px;font-weight:800;
    }
    .primary:hover{filter:brightness(1.04)}
    .status{
      margin-top:10px;font-size:12.5px;color:var(--muted);
      min-height:18px;
    }

    /* Result side */
    .big{
      font-size:36px;
      font-weight:900;
      letter-spacing:.2px;
      margin:4px 0 2px;
    }
    .sub{color:var(--muted);font-size:13px;margin:0 0 12px;line-height:1.35}
    .kpis{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px}
    @media (max-width:560px){.kpis{grid-template-columns:1fr}}
    .kpi{
      background:rgba(255,255,255,.04);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
    }
    .kpi .t{color:var(--muted);font-size:12px;margin-bottom:4px}
    .kpi .v{font-weight:850;font-size:16px}
    .kpi .v.pos{color:rgba(34,197,94,.95)}
    .kpi .v.neg{color:rgba(239,68,68,.95)}
    .chartwrap{
      margin-top:12px;
      background:rgba(255,255,255,.03);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 10px 8px;
    }
    .charthead{display:flex;align-items:center;justify-content:space-between;color:var(--muted);font-size:12px;margin-bottom:6px}
    canvas{width:100%;height:160px;display:block}
    /* Popover help */
    .popover{
      display:none;
      position:absolute;z-index:10;left:0;top:30px;
      width:min(320px, calc(100vw - 48px));
      background:rgba(15,18,30,.96);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
      box-shadow: 0 18px 38px rgba(0,0,0,.45);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.35;
    }
    .popover b{color:var(--text)}
    .modal{
      position:fixed;inset:0;background:rgba(0,0,0,.5);
      display:none;align-items:center;justify-content:center;padding:18px;z-index:50;
    }
    .modal .box{
      max-width:560px;width:100%;
      background:rgba(15,18,30,.98);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 26px 60px rgba(0,0,0,.55);
    }
    .modal h3{margin:0 0 8px}
    .modal p{margin:0 0 10px;color:var(--muted);line-height:1.5}
    .modal .close{margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  
    .ico{width:16px;height:16px;vertical-align:-3px;margin-right:8px;color:rgba(255,255,255,.85)}
    .btn .ico{margin-right:8px}
    .labelrow{display:flex;align-items:center;gap:10px}
    .labelrow .help{margin-left:6px}

/* ====== Multi-page navigation (tabs) ====== */
.tabs{
  display:flex;
  gap:10px;
  padding:10px 0 4px;
  flex-wrap:wrap;
}
.tab{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.04);
  color:var(--text);
  text-decoration:none;
  font-weight:700;
  letter-spacing:.2px;
}
.tab:hover{ background:rgba(255,255,255,.07); }
.tab.active{
  background:linear-gradient(135deg, rgba(124,58,237,.35), rgba(34,211,238,.18));
  border-color:rgba(124,58,237,.55);
}

/* ====== Home cards ====== */
.cards{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:14px;
}
@media (max-width:720px){ .cards{ grid-template-columns:1fr; } }
.cardlink{
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:16px;
  border-radius:18px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.04);
  box-shadow: var(--shadow);
  text-decoration:none;
  color:var(--text);
}
.cardlink:hover{ transform:translateY(-1px); background:rgba(255,255,255,.06); }
.cardtop{ display:flex; align-items:flex-start; gap:12px; }
.badge{
  width:38px; height:38px;
  border-radius:12px;
  display:grid; place-items:center;
  background:linear-gradient(135deg, rgba(124,58,237,.55), rgba(34,211,238,.35));
  border:1px solid rgba(255,255,255,.18);
}
.cardlink h2{ margin:0; font-size:18px; }
.cardlink p{ margin:0; color:var(--muted); line-height:1.45; }
.cardcta{ margin-top:6px; display:flex; align-items:center; gap:10px; }

/* ====== NDFL small helpers ====== */
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media (max-width:720px){ .row{ grid-template-columns:1fr; } }

/* Segmented control (radio) */
.seg{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:4px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.03);
  flex-wrap:wrap;
}
.seg input{
  position:absolute;
  opacity:0;
  pointer-events:none;
}
.seg label{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
  color:var(--muted);
  font-weight:800;
  font-size:13px;
  letter-spacing:.2px;
  user-select:none;
}
.seg input:focus + label{ outline:2px solid rgba(124,58,237,.35); outline-offset:2px; }
.seg input:checked + label{
  color:var(--text);
  background:rgba(124,58,237,.18);
  border:1px solid rgba(124,58,237,.30);
}

/* Checkbox row (clean) */
.chk{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.check{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.03);
  cursor:pointer;
  user-select:none;
}
.check input{ position:absolute; opacity:0; pointer-events:none; }
.check .box{
  width:18px; height:18px;
  border-radius:6px;
  border:1px solid rgba(255,255,255,.25);
  background:rgba(255,255,255,.02);
  display:grid; place-items:center;
}
.check input:checked + .box{
  background:rgba(124,58,237,.25);
  border-color:rgba(124,58,237,.55);
}
.check input:checked + .box:after{
  content:"";
  width:8px; height:8px;
  border-radius:3px;
  background:rgba(255,255,255,.9);
}

.smallnote{ color:var(--muted); font-size:12px; line-height:1.35; }

details.details summary{
  cursor:pointer;
  user-select:none;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.03);
  font-weight:700;
}
details.details[open] summary{ background:rgba(255,255,255,.05); }
.detailbox{
  white-space:pre-wrap;
  padding:12px 12px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.02);
}


/* --- NDFL improvements --- */
.page-ndfl .row .page-ndfl .field select{ width:100%; }
.page-ndfl .field select{ width:100%; }

.page-ndfl .seg{
  display:flex;
  gap:8px;
  align-items:center;
}
.page-ndfl .page-ndfl .seg label{
  flex:1;
  min-width:140px;
  text-align:center;
  justify-content:center;
}

.page-ndfl .brTable{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  margin-top:8px;
  overflow:hidden;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.03);
}
.page-ndfl .brTable th, .page-ndfl .brTable td{
  padding:10px 10px;
  font-size:13px;
  vertical-align:middle;
}
.page-ndfl .page-ndfl .brTable thead th{
  font-weight:600;
  color:rgba(255,255,255,.85);
  background:rgba(0,0,0,.20);
  border-bottom:1px solid rgba(255,255,255,.08);
}
.page-ndfl .page-ndfl .brTable tbody tr td{
  border-bottom:1px solid rgba(255,255,255,.06);
}
.page-ndfl .page-ndfl .brTable tbody tr:last-child td{
  border-bottom:none;
}
.page-ndfl .page-ndfl .brTable td.cRange{ white-space:nowrap; color:rgba(255,255,255,.80); }
.page-ndfl .brTable td.cBase, .page-ndfl .brTable td.cTax{ white-space:nowrap; }
.page-ndfl .page-ndfl .brTable td.cRate{ white-space:nowrap; color:rgba(255,255,255,.75); }
.page-ndfl .page-ndfl .brTable td.cBar{ width:26%; }

.page-ndfl .page-ndfl .barWrap{
  width:100%;
  height:10px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  overflow:hidden;
}
.page-ndfl .bar{
  height:100%;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(160,120,255,.85), rgba(110,220,255,.65));
}

.page-ndfl .smallnote{
  margin-top:6px;
  font-size:12px;
  color:rgba(255,255,255,.65);
}

/* Make dropdown rows comfortable on desktop */
@media (min-width: 980px){
  .page-ndfl .row{ grid-template-columns: 1fr 280px; }
}
