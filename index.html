<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Инфляционный калькулятор</title>
  <style>
    :root{
      --bg1:#070814;
      --bg2:#0b1a2a;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --muted2:rgba(255,255,255,.55);
      --accent:#7c3aed;
      --accent2:#22c55e;
      --danger:#ef4444;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --r:18px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--text);
      background: radial-gradient(1000px 600px at 15% 0%, rgba(124,58,237,.28), transparent 60%),
                  radial-gradient(900px 600px at 80% 30%, rgba(34,197,94,.16), transparent 55%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      padding:28px 18px;
    }
    .wrap{max-width:1080px;margin:0 auto}
    .top{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{
      width:40px;height:40px;border-radius:12px;
      background: linear-gradient(135deg, rgba(124,58,237,.9), rgba(34,197,94,.55));
      box-shadow: 0 10px 26px rgba(124,58,237,.25);
      display:grid;place-items:center;font-weight:800;
    }
    .title{line-height:1.1}
    .title h1{font-size:18px;margin:0}
    .title p{font-size:13px;margin:4px 0 0;color:var(--muted)}
    .actions{display:flex;gap:10px;align-items:center}
    .btn{
      appearance:none;border:1px solid var(--stroke);background:rgba(255,255,255,.04);
      color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;
      display:inline-flex;gap:8px;align-items:center;font-weight:650;
    }
    .btn:hover{background:rgba(255,255,255,.06)}
    .grid{display:grid;grid-template-columns: 1.05fr .95fr;gap:16px}
    @media (max-width: 900px){.grid{grid-template-columns:1fr}}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:16px;
      overflow:hidden;
    }
    .card h2{margin:0 0 12px;font-size:16px}
    .row{display:grid;grid-template-columns: 1fr 1fr;gap:12px}
    @media (max-width:560px){.row{grid-template-columns:1fr}}
    .field{position:relative}
    label{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:12.5px;margin:0 0 8px}
    .help{
      width:18px;height:18px;border-radius:999px;border:1px solid var(--stroke);
      background:rgba(255,255,255,.04);color:var(--muted);
      display:inline-grid;place-items:center;font-size:12px;cursor:pointer;user-select:none;
    }
    .help:hover{background:rgba(255,255,255,.06)}
    input, select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      font-size:15px;
    }
    select{cursor:pointer}
    .money{
      display:flex;align-items:center;gap:10px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
    }
    .money span{
      color:var(--muted);
      font-weight:700;
      width:14px;
    }
    .money input{
      border:none;background:transparent;padding:0;
      font-size:16px;
    }
    .swapline{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin:10px 0 0;
      padding:10px 12px;border-radius:14px;border:1px solid var(--stroke);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12.5px;
    }
    .swapbtn{
      border:none;background:rgba(255,255,255,.05);color:var(--text);
      padding:8px 10px;border-radius:12px;cursor:pointer;font-weight:750;
      border:1px solid var(--stroke);
    }
    .swapbtn:hover{background:rgba(255,255,255,.08)}
    .cta{
      margin-top:14px;
      display:flex;gap:10px;align-items:center;justify-content:flex-end;flex-wrap:wrap;
    }
    .primary{
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(124,58,237,.65));
      border:1px solid rgba(124,58,237,.55);
      padding:12px 16px;border-radius:14px;font-weight:800;
    }
    .primary:hover{filter:brightness(1.04)}
    .status{
      margin-top:10px;font-size:12.5px;color:var(--muted);
      min-height:18px;
    }

    /* Result side */
    .big{
      font-size:36px;
      font-weight:900;
      letter-spacing:.2px;
      margin:4px 0 2px;
    }
    .sub{color:var(--muted);font-size:13px;margin:0 0 12px;line-height:1.35}
    .kpis{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px}
    @media (max-width:560px){.kpis{grid-template-columns:1fr}}
    .kpi{
      background:rgba(255,255,255,.04);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
    }
    .kpi .t{color:var(--muted);font-size:12px;margin-bottom:4px}
    .kpi .v{font-weight:850;font-size:16px}
    .kpi .v.pos{color:rgba(34,197,94,.95)}
    .kpi .v.neg{color:rgba(239,68,68,.95)}
    .chartwrap{
      margin-top:12px;
      background:rgba(255,255,255,.03);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 10px 8px;
    }
    .charthead{display:flex;align-items:center;justify-content:space-between;color:var(--muted);font-size:12px;margin-bottom:6px}
    canvas{width:100%;height:160px;display:block}
    /* Popover help */
    .popover{
      display:none;
      position:absolute;z-index:10;left:0;top:30px;
      width:min(320px, calc(100vw - 48px));
      background:rgba(15,18,30,.96);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
      box-shadow: 0 18px 38px rgba(0,0,0,.45);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.35;
    }
    .popover b{color:var(--text)}
    .modal{
      position:fixed;inset:0;background:rgba(0,0,0,.5);
      display:none;align-items:center;justify-content:center;padding:18px;z-index:50;
    }
    .modal .box{
      max-width:560px;width:100%;
      background:rgba(15,18,30,.98);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 26px 60px rgba(0,0,0,.55);
    }
    .modal h3{margin:0 0 8px}
    .modal p{margin:0 0 10px;color:var(--muted);line-height:1.5}
    .modal .close{margin-top:8px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo">₽</div>
        <div class="title">
          <h1>Инфляционный калькулятор</h1>
          <p>Пересчёт цены между годами по выбранной категории</p>
        </div>
      </div>
      <div class="actions">
        <button class="btn" id="helpOpen">Справка</button>
        <button class="btn" id="copyBtn">Копировать результат</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h2>Введите цену и годы</h2>

        <div class="row">
          <div class="field">
            <label>Сколько стоило
              <span class="help" data-help="h_amount">?</span>
              <span class="popover" id="h_amount"><b>Сумма</b> в рублях в выбранном исходном году. Пример: цена телефона в 2010.</span>
            </label>
            <div class="money">
              <span>₽</span>
              <input id="amount" inputmode="numeric" placeholder="100 000" />
            </div>
          </div>

          <div class="field">
            <label>Категория цен
              <span class="help" data-help="h_cat">?</span>
              <span class="popover" id="h_cat">Выберите общий индекс или конкретную группу товаров/услуг.</span>
            </label>
            <select id="series"></select>
          </div>
        </div>

        <div class="row" style="margin-top:10px">
          <div class="field">
            <label>Цена была в году
              <span class="help" data-help="h_from">?</span>
              <span class="popover" id="h_from">Год, в ценах которого указана исходная сумма.</span>
            </label>
            <select id="fromYear"></select>
          </div>

          <div class="field">
            <label>Перевести в цены года
              <span class="help" data-help="h_to">?</span>
              <span class="popover" id="h_to">Год, для которого вы хотите получить эквивалентную цену.</span>
            </label>
            <select id="toYear"></select>
          </div>
        </div>

        <div class="swapline">
          <div id="directionText">—</div>
          <button class="swapbtn" id="swapBtn" title="Поменять годы местами">↔ Поменять</button>
        </div>

        <div class="cta">
          <button class="btn" id="resetBtn">Сброс</button>
          <button class="btn primary" id="calcBtn">Рассчитать</button>
        </div>

        <div class="status" id="status">Загрузка данных…</div>
      </div>

      <div class="card">
        <h2>Результат</h2>
        <p class="sub" id="summary">—</p>

        <div class="big" id="resultValue">—</div>

        <div class="kpis">
          <div class="kpi">
            <div class="t">Разница</div>
            <div class="v" id="diffValue">—</div>
          </div>
          <div class="kpi">
            <div class="t">В процентах</div>
            <div class="v" id="pctValue">—</div>
          </div>
          <div class="kpi">
            <div class="t">Во сколько раз</div>
            <div class="v" id="factorValue">—</div>
          </div>
        </div>

        <div class="chartwrap">
          <div class="charthead">
            <span>Эквивалент по годам</span>
            <span class="mono" id="rangeTag">—</span>
          </div>
          <canvas id="chart" width="900" height="260"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="helpModal">
    <div class="box">
      <h3>Как пользоваться</h3>
      <p>1) Введите сумму и год, <b>когда эта цена была актуальна</b>.</p>
      <p>2) Выберите год, <b>в цены которого</b> нужно пересчитать.</p>
      <p>3) Если хотите посчитать наоборот, нажмите <b>↔ Поменять</b>.</p>
      <p>Данные: официальные индексы потребительских цен (Росстат), пересчитаны в годовые темпы (в процентах).</p>
      <button class="btn close" id="helpClose">Закрыть</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
